<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">


    <title>公告</title>
	 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<link href="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.min.css" rel="stylesheet">
	<script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table-zh-CN.js"></script>

   <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
	<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
	<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
	
	
	<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
	<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

	
	
    <!-- Custom styles for this template -->
    <link href="../css/announcementList.css" rel="stylesheet">


  </head>

  <body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="announcement.html">返回</a>
        </div>
      </div>

    </nav>

	<div class="content">  
    <h1>XX公司近日公告</h1>  
		
    <table id="table" class="table table-hover" data-classes="table table-hover"  
           data-striped="true"  >  
        
    </table>  

	</div>  

	<div class="content">
    <div class="table-responsive"> 
        <div id="toolbar">
        <a href="javascript:void(0);" class="btn btn-danger btn-xs" onclick="announceDel()"><i class="icon iconfont"></i>删除</a>
        </div>
        <table id="taskList_table" class="table-striped table-hover" data-mobile-responsive="true"></table>
    </div>
  </div>

	<script>
    $(document).ready(function(){ 
      //var data0;
      /*$.ajax({
            type: "GET",
            url: 'http://115.159.38.100:3000/bulletin',
                    
            success: function (datas, textStatus){ 
              data0=datas;
              alert("ssss");
            }//==sucess function       
        }); //====ajax  */

      //bootstrapTable 表格数据初始化 
      var table = $('#table').bootstrapTable({
          url: 'http://115.159.38.100:3000/bulletin',
          method:  "GET",
          cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
          pagination: true,                   //是否显示分页（*）
          sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
          pageNumber: 1,                       //初始化加载第一页，默认第一页
          pageSize: 10,                       //每页的记录行数（*）
          pageList: [10, 25, 50],             //可供选择的每页的行数（*）
          paginationPreText: "上一页",
          paginationNextText: "下一页",

          toolbar: '#toolbar',                //工具按钮用哪个容器
          sortable: true,                     //是否启用排序
          sortOrder: "asc",                   //排序方式
          //queryParams: oTableInit.queryParams,//传递参数（*）

         

          search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端
          strictSearch: false,// 是否严格搜索
          searchOnEnterKey: false, //设置为 true时，按回车触发搜索方法，否则自动触发搜索方法

          clickToSelect: true,
          striped: true,                              //是否显示行间隔色
          showColumns: true, //是否显示所有的列
          minimumCountColumns: 2, //最少允许的列数
          showRefresh: true, //是否显示刷新按钮
          showToggle:true, //是否显示详细视图和列表视图的切换按钮

          //showExport: true,                     //是否显示导出
          //exportDataType: "basic",              //basic', 'all', 'selected'.


          columns: [
          {
            //checkbox:true,
            radio: true
          },
          {
            field: 'number',
            title: 'number',
            visible:false,
            formatter: function (value, row, index) {
                 return index+1;
            }

            },{
            field: 'departName',
            title: '部门名称',
            align: 'center',
            width:120,
            sortable: true
            }, {
            field: 'name',
            title: '公告名称',
            align: 'center',
            width:200
            }, {
            field: 'content',
            title: '内容'
            }, {
            field: 'time',
            title: '时间',
            align: 'center',
            sortable: true,
            width:200
          }],

          //data: data0
      });//=====bootstrapTable   

 /********** bootstrapTable toolbar 按钮事件 *********/  
      announceDel = function () {  
       // alert("122");
        var selectContent = table.bootstrapTable('getSelections')[0]; 
        
        if(typeof(selectContent) == 'undefined') {  
            alert('请选择一个公告!');  
            return false;  
        }else{  
            //alert(selectContent.number);
            
            var datas = new Object();
            datas.time = selectContent.time;
            //alert(datas.time);

            $.ajax({
               type: "POST",
               url: 'http://115.159.38.100:3000/bulletin/delete',
               data: datas,
               cache:false,
               async : true,
               dataType : "json",
               success: function(data){
                  if(data == "success"){    

                    //alert("删除成功！");
                    table.bootstrapTable('refresh');

                    } else {

                    alert("删除失败");     
                   // table.bootstrapTable('refresh');                
                    }
               }
            }); 

        }// =====else

      }//==announceDel
    
            
    }); //==ready function

  </script> 


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
   
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
 
  </body>
</html>
